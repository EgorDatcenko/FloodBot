# üé¨ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Å—ã–ª–∫–∏ –º–µ–¥–∏–∞ –≤ –ø–æ—Å—Ç–∞—Ö - –û–¢–ß–ï–¢

## ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ extract_media_info** - –ò–°–ü–†–ê–í–õ–ï–ù–û ‚úÖ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–ª 3 –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ 2
- **–†–µ—à–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–∏–ª –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ `(media_type, media_file_id)`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£–±—Ä–∞–ª –ª–∏—à–Ω–∏–π `media_file_unique_id`, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è

### 2. **–£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–µ–¥–∏–∞** - –ò–°–ü–†–ê–í–õ–ï–ù–û ‚úÖ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ–¥–∏–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏–ª –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ `bot.get_file()` –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–µ–¥–∏–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ

### 3. **–†–∞—Å—à–∏—Ä–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤ –º–µ–¥–∏–∞** - –ò–°–ü–†–ê–í–õ–ï–ù–û ‚úÖ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ video, photo, animation
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏–ª –ø–æ–¥–¥–µ—Ä–∂–∫—É audio, document, voice, video_note, sticker
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ —Ç–∏–ø—ã –º–µ–¥–∏–∞ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

### 4. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –º–µ–¥–∏–∞** - –ò–°–ü–†–ê–í–õ–ï–ù–û ‚úÖ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –æ—à–∏–±–∫–µ –º–µ–¥–∏–∞ –ø–æ—Å—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª—Å—è –≤–æ–æ–±—â–µ
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏–ª fallback –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç–∞
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ—Å—Ç—ã –≤—Å–µ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ –º–µ–¥–∏–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ

## üîß **–ö–õ–Æ–ß–ï–í–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø:**

### ContentAnalyzer (content_analyzer.py):
```python
def extract_media_info(self, message) -> Tuple[str, str]:
    """
    –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ–¥–∏–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: (media_type, media_file_id)
    """
    # –£–±—Ä–∞–ª media_file_unique_id –∏–∑ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    # –£–ª—É—á—à–∏–ª –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –º–µ–¥–∏–∞
```

### ForwardedMessageHandler (bot.py):
```python
async def forwarded_message_handler(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∫–∞–Ω–∞–ª–∞ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –º–µ–¥–∏–∞"""
    # –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–µ–¥–∏–∞
    # –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
    # –ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### ShowCategoryContent (bot.py):
```python
async def show_category_content_text(self, update: Update, category: str):
    """–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –±–æ—Ç–∞ (—Å –º–µ–¥–∏–∞, –µ—Å–ª–∏ –µ—Å—Ç—å)"""
    # –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–µ–¥–∏–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
    # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –º–µ–¥–∏–∞
    # –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```

## üì± **–ü–û–î–î–ï–†–ñ–ò–í–ê–ï–ú–´–ï –¢–ò–ü–´ –ú–ï–î–ò–ê:**

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:
- **üé• –í–∏–¥–µ–æ** (`video`) - —Å caption
- **üì∏ –§–æ—Ç–æ** (`photo`) - —Å caption  
- **üé¨ –ê–Ω–∏–º–∞—Ü–∏–∏** (`animation`) - —Å caption
- **üéµ –ê—É–¥–∏–æ** (`audio`) - —Å caption
- **üìÑ –î–æ–∫—É–º–µ–Ω—Ç—ã** (`document`) - —Å caption
- **üé§ –ì–æ–ª–æ—Å–æ–≤—ã–µ** (`voice`) - —Å caption
- **üìπ –í–∏–¥–µ–æ-—Å–æ–æ–±—â–µ–Ω–∏—è** (`video_note`) - —Ç–µ–∫—Å—Ç –æ—Ç–¥–µ–ª—å–Ω–æ
- **üòÄ –°—Ç–∏–∫–µ—Ä—ã** (`sticker`) - —Ç–µ–∫—Å—Ç –æ—Ç–¥–µ–ª—å–Ω–æ

### üîÑ –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏** - `bot.get_file(file_id)`
2. **–û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞** - –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
3. **Fallback –Ω–∞ —Ç–µ–∫—Å—Ç** - –µ—Å–ª–∏ –º–µ–¥–∏–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ

## üõ†Ô∏è **–î–û–ë–ê–í–õ–ï–ù–ù–´–ï –ò–ù–°–¢–†–£–ú–ï–ù–¢–´:**

### 1. **check_media_in_db.py** - –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–¥–∏–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
```bash
python check_media_in_db.py
```
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã –≤ –±–∞–∑–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã –º–µ–¥–∏–∞

### 2. **test_media_forwarding.py** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Å—ã–ª–∫–∏
```bash
python test_media_forwarding.py
```
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–∞–º
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç file_id

### 3. **–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤ Database**:
- `get_content_with_media()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ —Å –º–µ–¥–∏–∞
- `get_content_by_media_type()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ —Ç–∏–ø—É –º–µ–¥–∏–∞

## üìä **–£–õ–£–ß–®–ï–ù–ò–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò:**

### 1. **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–¥–∏–∞**
- –ú–µ–¥–∏–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –ò–∑–±–µ–≥–∞–µ–º –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤

### 2. **–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –º–µ–¥–∏–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### 3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–µ—Ä–µ—Å—ã–ª–∫–∞**
- –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –ø–µ—Ä–µ—Å–ª–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ file_id
- –î–≤–æ–π–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

## üéØ **–†–ï–ó–£–õ–¨–¢–ê–¢:**

### ‚úÖ **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü–µ—Ä–µ—Å—ã–ª–∫–∞ –º–µ–¥–∏–∞ –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ –≤ –õ–° –±–æ—Ç—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–µ–¥–∏–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –º–µ–¥–∏–∞ Telegram
- –£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Fallback –Ω–∞ —Ç–µ–∫—Å—Ç –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–µ–¥–∏–∞

### üìà **–£–ª—É—á—à–µ–Ω–∏—è:**
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ú–µ–¥–∏–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –º–µ–¥–∏–∞
- **–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**: –ü–æ—Å—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –º–µ–¥–∏–∞
- **–û—Ç–ª–∞–¥–∫–∞**: –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

## üöÄ **–ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ:**

### –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:
```bash
python bot.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–∏–∞:
```bash
python check_media_in_db.py
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
1. **–ü–µ—Ä–µ—Å—ã–ª–∞–π—Ç–µ –ø–æ—Å—Ç—ã** –∏–∑ –∫–∞–Ω–∞–ª–æ–≤ –≤ –õ–° –±–æ—Ç—É
2. **–ú–µ–¥–∏–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
3. **–ü—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** –º–µ–¥–∏–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
4. **–ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–µ–¥–∏–∞** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç

## üéâ **–ò–¢–û–ì:**
–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–µ—Ä–µ—Å—ã–ª–∫–æ–π –º–µ–¥–∏–∞ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã! –ë–æ—Ç —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –º–µ–¥–∏–∞ —Å —É–º–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.

**–°—Ç–∞—Ç—É—Å: –ú–ï–î–ò–ê –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û** ‚úÖ 