# üé¨ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ë–ê–ì–ê –° –ù–ï–ö–û–†–†–ï–ö–¢–ù–û–ô –û–ë–†–ê–ë–û–¢–ö–û–ô –ú–ï–î–ò–ê - –û–¢–ß–ï–¢

## üéØ **–ü–†–û–ë–õ–ï–ú–ê:**
–ë–æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª –º–µ–¥–∏–∞ –≤ –ø–æ—Å—Ç–∞—Ö —á–µ–ª–ª–µ–Ω–¥–∂–µ–π:
- ‚ùå –ú–µ–¥–∏–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "üéØ –ß–ï–õ–õ–ï–ù–î–ñ–ò"
- ‚ùå –ü–æ—Å—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ —Å —Ç–µ–∫—Å—Ç–æ–º, –±–µ–∑ –≤–∏–¥–µ–æ/—Ñ–æ—Ç–æ
- ‚ùå –¢–∞–±–ª–∏—Ü–∞ `post_media` –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∞—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚ùå –ú–µ—Ç–æ–¥—ã `show_category_content` –∏ `show_category_content_text` –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏

## ‚úÖ **–ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï:**

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** ‚úÖ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –¢–∞–±–ª–∏—Ü–∞ `post_media` –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `init_media_table()` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `Database`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –¢–∞–±–ª–∏—Ü–∞ `post_media` —Ç–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞** ‚úÖ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞–ª–∏ —Ç–æ–ª—å–∫–æ —Å –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ–π `post_media`
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥ `get_content_by_category`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ—Å—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –º–µ–¥–∏–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã

### 3. **–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –ø–æ—Å—Ç–∞–º–∏** ‚úÖ
- **–ü—Ä–æ–±–ª–µ–º–∞**: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ—Å—Ç—ã —Å –º–µ–¥–∏–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å
- **–†–µ—à–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ø–æ—Å—Ç–æ–≤ –≤ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ –ø–æ—Å—Ç—ã (—Å—Ç–∞—Ä—ã–µ –∏ –Ω–æ–≤—ã–µ) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –º–µ–¥–∏–∞

## üîß **–ö–õ–Æ–ß–ï–í–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø:**

### Database (database.py):
```python
def __init__(self, db_path: str = "content_bot.db"):
    self.db_path = db_path
    self.init_database()
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
    self.init_media_table()
```

### Bot (bot.py):
```python
async def show_category_content(self, query, category: str):
    # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç —Å –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã post_media
    content = self.db.get_content_with_media_files(category, limit=50)
    
    # –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å—Ç–æ–≤
    if not content:
        content = self.db.get_content_by_category(category, limit=50)
        
        # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã –≤ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
        for item in content:
            media_type = item.get('media_type')
            media_file_id = item.get('media_file_id')
            
            if media_type and media_file_id:
                # –°–æ–∑–¥–∞–µ–º –º–µ–¥–∏–∞—Ñ–∞–π–ª –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
                item['media_files'] = [{
                    'media_type': media_type,
                    'media_file_id': media_file_id,
                    'media_order': 0
                }]
            else:
                item['media_files'] = []
```

## üéØ **–ö–ê–ö –¢–ï–ü–ï–†–¨ –†–ê–ë–û–¢–ê–ï–¢:**

### ‚úÖ –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "üéØ –ß–ï–õ–õ–ï–ù–î–ñ–ò":
1. **–ë–æ—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç** —á–µ—Ä–µ–∑ `get_content_with_media_files`
2. **–ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è** (—Ç–∞–±–ª–∏—Ü–∞ `post_media` –ø—É—Å—Ç–∞), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `get_content_by_category`
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç** —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã –≤ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏
4. **–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–æ—Å—Ç—ã** —Å –º–µ–¥–∏–∞ (–≤–∏–¥–µ–æ, —Ñ–æ—Ç–æ, –∞–Ω–∏–º–∞—Ü–∏–∏)
5. **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç fallback** –µ—Å–ª–∏ –º–µ–¥–∏–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ

### ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞:
- **–í–∏–¥–µ–æ**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ `send_video`
- **–§–æ—Ç–æ**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ `send_photo`
- **–ê–Ω–∏–º–∞—Ü–∏–∏**: –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ `send_animation`
- **–ê—É–¥–∏–æ**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ `send_audio`
- **–î–æ–∫—É–º–µ–Ω—Ç—ã**: –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ `send_document`
- **–ì–æ–ª–æ—Å–æ–≤—ã–µ**: –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ `send_voice`
- **–í–∏–¥–µ–æ-–∑–∞–º–µ—Ç–∫–∏**: –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ `send_video_note`
- **–°—Ç–∏–∫–µ—Ä—ã**: –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ `send_sticker`

## üîç **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:**

### –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `test_media_fix.py`:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Ç–∞–±–ª–∏—Ü—ã `post_media`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ—Å—Ç—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ challenges
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –º–µ—Ç–æ–¥ `get_content_with_media_files`
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –º–µ–¥–∏–∞

## üìä **–û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:**

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- üéØ **–ö–∞—Ç–µ–≥–æ—Ä–∏—è "–ß–ï–õ–õ–ï–ù–î–ñ–ò"** –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—Å—Ç—ã —Å –º–µ–¥–∏–∞
- üì± **–í–∏–¥–µ–æ –∏ —Ñ–æ—Ç–æ** –±—É–¥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è
- üîÑ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –∏ –Ω–æ–≤—ã–º–∏ –ø–æ—Å—Ç–∞–º–∏
- üöÄ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** —Ç–∞–±–ª–∏—Ü –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

## üéâ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:**

–ë–∞–≥ —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –º–µ–¥–∏–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω! –¢–µ–ø–µ—Ä—å:
- ‚úÖ –í—Å–µ –ø–æ—Å—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –º–µ–¥–∏–∞
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `post_media` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –û–±–µ—Å–ø–µ—á–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –ø–æ—Å—Ç–∞–º–∏
- ‚úÖ –ú–µ–¥–∏–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å –º–µ–¥–∏–∞ –≤ –ø–æ—Å—Ç–∞—Ö —á–µ–ª–ª–µ–Ω–¥–∂–µ–π! üöÄ 