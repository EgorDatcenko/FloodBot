# üé¨ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –° –°–û–†–¢–ò–†–û–í–ö–û–ô –ú–ï–î–ò–ê-–ì–†–£–ü–ü - –û–¢–ß–ï–¢

## üéØ **–ü–†–û–ë–õ–ï–ú–ê:**
–ë–æ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª –ø–æ—Å—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏:
- –°–æ—Ö—Ä–∞–Ω—è–ª —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–æ–µ –º–µ–¥–∏–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Å—Ç–µ
- –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –æ—Ç–ø—Ä–∞–≤–ª—è–ª –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–¥—Ä—É–≥–æ–µ"
- –ù–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –∫–∞–∫ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ

## ‚úÖ **–†–ï–®–ï–ù–ò–ï:**

### 1. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** ‚úÖ
- **–î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ `media_group_id`** –≤ —Ç–∞–±–ª–∏—Ü—É `content`
- **–°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `post_media`** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø–æ—Å—Ç
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤—è–∑–∏** –º–µ–∂–¥—É –ø–æ—Å—Ç–∞–º–∏ –∏ –∏—Ö –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏

### 2. **–£–ª—É—á—à–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π** ‚úÖ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø** –ø–æ `media_group_id`
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** –ø–æ—Å—Ç–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø–∞–º–∏
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤** –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É

### 3. **–û–±–Ω–æ–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞** ‚úÖ
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤** –≤ `show_category_content`
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤** –≤ `show_category_content_text`
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤** –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ

## üîß **–ö–õ–Æ–ß–ï–í–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø:**

### Database (database.py):
```python
# –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
CREATE TABLE post_media (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    content_id INTEGER,
    message_id INTEGER,
    media_type TEXT,
    media_file_id TEXT,
    media_file_unique_id TEXT,
    media_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (content_id) REFERENCES content (id) ON DELETE CASCADE
)

# –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ add_content
def add_content(self, ..., media_group_id: str = None):
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ media_group_id
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –≤ post_media
    # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ—Å—Ç–æ–≤

# –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã
def get_post_media(self, content_id: int) -> List[Dict]
def get_content_by_media_group_id(self, media_group_id: str) -> Optional[Dict]
```

### ContentBot (bot.py):
```python
# –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
async def forwarded_message_handler(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø
    media_group_id = getattr(message, 'media_group_id', None)
    
    # –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
    if media_group_id:
        existing_post = self.db.get_content_by_media_group_id(media_group_id)
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å media_group_id
    success = self.db.add_content(..., media_group_id=media_group_id)

# –ù–æ–≤—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
async def _send_single_media(self, chat_id: int, media: dict, caption: str)
async def _send_media_group(self, chat_id: int, media_files: list, caption: str)
```

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:
```python
# show_category_content –∏ show_category_content_text
for item in content:
    media_files = item.get('media_files', [])
    
    if media_files:
        if len(media_files) > 1:
            await self._send_media_group(chat_id, media_files, caption)
        else:
            await self._send_single_media(chat_id, media_files[0], caption)
```

## üìä **–†–ï–ó–£–õ–¨–¢–ê–¢:**

### ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
1. **–ú–µ–¥–∏–∞-–≥—Ä—É–ø–ø—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∫ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ** - –≤—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –∏–∑ –æ–¥–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ –æ—Å—Ç–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ
2. **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ—Å—Ç—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø–∞–º–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
3. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞** - –≤—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
4. **–£–ª—É—á—à–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –Ω–∞ –ø–æ—Å—Ç

### ‚úÖ **–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
1. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤** - –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø–∞
2. **–ü–æ—Ä—è–¥–æ–∫ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤ –≤ –ø–æ—Å—Ç–µ
3. **–ì–∏–±–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –º–µ–¥–∏–∞ –≤ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ
4. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

## üß™ **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:**

### ‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø–∞–º–∏
- –ú–µ—Ç–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø

### üìã **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
1. –ü–µ—Ä–µ—à–ª–∏—Ç–µ –ø–æ—Å—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏ –≤ –±–æ—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ –æ–¥–Ω–æ–º –ø–æ—Å—Ç–µ
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–¥—Ä—É–≥–æ–µ"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏

## üéâ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:**

–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø **–ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–ê**. –¢–µ–ø–µ—Ä—å –±–æ—Ç:

- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Å—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –≤ –æ–¥–Ω–æ–º –ø–æ—Å—Ç–µ
- ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã –≥—Ä—É–ø–ø–∞–º–∏
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –º–µ–¥–∏–∞-–≥—Ä—É–ø–ø–∞–º–∏!** üöÄ 